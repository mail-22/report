procedure TEditGridJOleForm.MakeUniqName;
var
  strTempFile: array[0..MAX_PATH - 1] of char;
  nTempNumber: integer;
  bFileExist: Boolean;
  bResult: Boolean;
  strTmp: string;

  guid: tguid;
begin
  // TODO -cMM: TEditGridJOleForm.MakeUniqName default body inserted

//begin
//  nTempNumber := Windows.GetTempFileName(PChar(BDDirPathName), '_prefix_', 0, strTempFile);
//  FileNamePathUniq := strTempFile ;
//end;

  Createguid(guid);
  FileNamePathUniq := BDDirPathName + GUIDToString(guid);

  UniqueName := SysUtils.ExtractFileName(FileNamePathUniq);

  FileName := SysUtils.ExtractFileName(FileNamePathSource);
  FileName := SysUtils.ChangeFileExt(FileName, '');
  ext := ExtractFileExtOnly(FileNamePathSource);

  bResult := CopyFile(PChar(FileNamePathSource), PChar(FileNamePathUniq),
    bFileExist);
  if bResult then
  begin
    ; // ok!
  end
  else
  begin
    { TODO -oSVS : svs err }
    //strTmp := SysErrorMessage(GetLastError);
    MessageDlg(FileNamePathSource + ' ' + FileNamePathUniq + ' '
      + SysErrorMessage(GetLastError), mtWarning, [mbOK], 0);
  end;

  DataSet.Append; //!!!
  DataSet.RecNo;
  DataSet.RecordCount; //
  if not (DataSet.State in [dsInsert, dsEdit]) then
    DataSet.Edit;

  DataSet.FieldByName('idR1').AsInteger :=
    dm.tblReport2.FieldByName('id').AsInteger; //

  DataSet.FieldByName('filename').AsString := FileName; //
  DataSet.FieldByName('filepath').AsString := FileNamePathSource; //
  DataSet.FieldByName('ext').AsString := ext; //
  DataSet.FieldByName('UniqueName').AsString := UniqueName; //

  DataSet.Post;
  DataSet.RecNo;
  DataSet.RecordCount;
end;